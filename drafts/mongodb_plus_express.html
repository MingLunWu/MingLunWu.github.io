<!DOCTYPE html>
<!--[if lt IE 9 ]><html class="no-js oldie" lang="en"> <![endif]-->
<!--[if IE 9 ]><html class="no-js oldie ie9" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
        <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <!--
    <meta name="description" content="">
    <meta name="author" content="">
    -->
    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="https://minglunwu.github.io/theme/css/base.css">
    <!--<link rel="stylesheet" href="https://minglunwu.github.io/theme/css/vendor.css">-->
    <link rel="stylesheet" href="https://minglunwu.github.io/theme/css/main.css">
    <link rel="stylesheet" href="https://minglunwu.github.io/theme/css/styles.css">

    <!-- script
    ================================================== -->
    <script src="https://minglunwu.github.io/theme/js/modernizr.js"></script>
    <script src="https://minglunwu.github.io/theme/js/pace.min.js"></script>
    <!--<script src="https://kit.fontawesome.com/968a4ded4c.js" crossorigin="anonymous"></script>-->

    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="https://minglunwu.github.io/theme/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://minglunwu.github.io/theme/favicon.ico" type="image/x-icon">

    <title>使用Docker，快速佈建MongoDB + Mongo Express</title>
    <meta property="og:title" content="使用Docker，快速佈建MongoDB + Mongo Express">
    <meta name="description" content="<p>使用Docker快速建立MongoDB以及Web IDE</p>">
    <meta property="og:description" content="<p>使用Docker快速建立MongoDB以及Web IDE</p>">
    <meta name="author" content="MingLun Allen Wu">
    <meta property="og:image" content="https://images.unsplash.com/photo-1501619757722-90657a99803b?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80">
    
    <link rel="image_src" type="image/jpeg" href="https://images.unsplash.com/photo-1501619757722-90657a99803b?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80" />
    <style>
        img{
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
</head>

<body id="top">
            <!-- header
    ================================================== -->
    <header class="s-header">

        <div class="header-logo">
            <a class="site-logo" href="https://minglunwu.github.io"><img src="https://minglunwu.github.io/theme/images/logo.png" width="160" height="56" alt="Homepage"></a>
        </div>

        <nav class="header-nav-wrap">
            <ul class="header-nav">
                <li class="current"><a href="https://minglunwu.github.io/#home" title="home">Home</a></li>
                <li><a href="https://minglunwu.github.io/#about" title="about">About</a></li>
                <li><a href="https://minglunwu.github.io/#blog" title="blog">Blogs</a></li>
                <li><a href="https://minglunwu.github.io/#note" title="note">Notes</a></li>
                <!--<li><a class="smoothscroll" href="#note" title="notes">Notes</a></li>-->
                <!--<li><a class="smoothscroll"  href="#contact" title="contact">Contact</a></li>-->
            </ul>
        </nav>

        <a class="header-menu-toggle" href="#0"><span>Menu</span></a>

    </header> <!-- end s-header -->

        <article class="blog-single">

            <!-- page header/blog hero
            ================================================== -->
            <div class="page-header page-header--single page-hero" style="background-image:url(https://images.unsplash.com/photo-1501619757722-90657a99803b?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80)">
            
                <div class="row page-header__content narrow">
                    <article class="col-full">
                        <div class="page-header__info">
                            <div class="page-header__cat">
                                    <a href="#0">Docker</a>
                                    <a href="#0">MongoDB</a>
                            </div>
                        </div>
                        <h1 class="page-header__title">
                            <a href="#0" title="">
                                使用Docker，快速佈建MongoDB + Mongo Express
                            </a>
                        </h1>
                        <ul class="page-header__meta">
                            <li class="date">2021- 1-06 (三)</li>
                            <li class="author">
                                By
                                <span>MingLun Allen Wu</span>
                            </li>
                        </ul>
                        
                    </article>
                </div>
        
            </div> <!-- end page-header -->
    
            <div class="row blog-content">
                <div class="col-full blog-content__main">
                    
                    <h1>前言</h1>
<p>最近工作時，需要寫爬蟲收集某些論壇的資料</p>
<p>我們要做的事情是: </p>
<ul>
<li>使用 Docker 建立一個 <code>MongoDB</code> Container：
    省去繁瑣的安裝及設定，以最短的時間建立一個MongoDB服務。</li>
<li>使用 Docker 建立一個 <code>Mongo Express</code> Container:
    這是一個輕量級的 MongoDB Web GUI，能夠透過網頁介面輕易地瀏覽資料結構、檔案內容。</li>
</ul>
<p>Mongo Express 的基本介紹請參閱<a href="https://github.com/mongo-express/mongo-express">官方 Github</a></p>
<h1>Step 1. 基本設定</h1>
<p>在這個章節我們需要先進行基本的環境設定: </p>
<h2>網路設定 (docker-network)</h2>
<p>在這篇筆記中，我們會建立兩個 Docker Container，其中 <code>Mongo Express</code> 是 <code>MongoDB</code>的 GUI，兩個Container之間是需要連線的。</p>
<p>Docker Container 在建立時，可以設定不同的網路模式(Docker Network)，這關係到外部與Container的連線，大致上可以分為幾種模式: </p>
<ul>
<li><code>None</code>: 外部無法與Container進行任何連線。</li>
<li><code>Host</code>: 在主機A上開啟的Container B，可以直接在 <code>&lt;A的ip&gt;:&lt;B開啟的port&gt;</code> 取得服務</li>
<li><code>Bridge</code>: 最常見的模式，可以想像成建立一個獨立的橋樑，啟動Container時可以指定此橋樑，則這些擁有橋樑的Container之間可以互通有無。 (我們建立一個橋樑，並且提供給 <code>MongoDB</code> 及 <code>Mongo Express</code>，則這兩者之間就能互相連線)</li>
<li><code>Overlay</code>: 適用於跨主機間的Docker連線。</li>
</ul>
<p>更多 Docker Network 的細節可以參考 <a href="https://yu-jack.github.io/2020/05/18/docker-network/">Docker 網路介紹</a> 這篇文章。</p>
<h3>建立Network</h3>
<div class="highlight"><pre><span></span><span class="c1"># docker network create -d &lt;模式&gt; &lt;名稱&gt;</span>
docker network create -d bridge mongo-network  <span class="c1"># 建立 Docker Network</span>
docker network ls <span class="c1"># 顯示所有的Docker Network</span>
</pre></div>


<h2>設定Volume (Optional)</h2>
<p>建立 <code>MongoDB</code> Container時，資料會儲存在 Container內部，在這樣的情境下是可以正常讀取/寫入的。</p>
<p>然而如果這個Container被移除(<code>docker rm</code>)後，裡面的資料就會全部消失了！ 這好嗎？ 這不好</p>
<p><strong>如果只是想要測試<code>MongoDB</code>的功能，不在乎資料遺失的話，可以直接跳過這個步驟！</strong></p>
<p>在建立Container時，通常會進行<strong>Volume</strong>的操作，也就是將 <strong>Container內部的某個資料夾</strong> 與 <strong>主機上的某個實體資料夾</strong> 綁定</p>
<p><strong>一榮俱榮、一損俱損，對實體資料夾的操作，也等於對Container內部的資料夾進行操作，反之亦然。</strong></p>
<p>Container內部有自己的資料夾結構，就像是個獨立的小世界，<code>MongoDB</code>在執行時會將資料以某種特定的形式寫入到「某個資料夾」中。 我們所要做的，就是將這個資料夾透過<code>volume</code>鏡像映射到主機的某個資料夾。</p>
<p>使用Volume有什麼好處呢？</p>
<p>資料儲存在實體主機上後，將不會因為Container的移除而消失。啟動新的Container時，只要在進行一次掛載，即可無痛將資料「放回」Container中。</p>
<p>接下來我們先在主機上創立一個實體的資料夾，用來存放Docker Volume的資料(路徑可以自訂)</p>
<div class="highlight"><pre><span></span>mkdir /mnt/mongodb
</pre></div>


<h1>Step 2. 設定 MongoDB</h1>
<p>Docker Image 部分使用官方提供的Docker File: 
<a href="https://hub.docker.com/_/mongo">Docker Hub 連結</a></p>
<p>其中也包含基本的設定文件。</p>
<h2>下載 Docker Image</h2>
<div class="highlight"><pre><span></span>docker pull mongo:latest <span class="c1"># 從 Docker Hub 將 Image Pull到本地端</span>
docker image <span class="c1"># 確認本地端現有的 Docker Image</span>
</pre></div>


<p>在建立Container時，會用到許多標籤，分別有不同的意義，接下來分別介紹:</p>
<h3><code>-e</code> 設定環境變數</h3>
<p>在啟動 <code>MongoDB</code> 的 Container 時，需要設定兩個環境變數，這兩個變數是用來設定 <code>MongoDB</code>的最高權限使用者帳號及密碼: </p>
<ul>
<li><code>MONGO_INITDB_ROOT_USERNAME</code>: 帳號</li>
<li><code>MONGO_INITDB_ROOT_PASSWORD</code>: 密碼</li>
</ul>
<p>在啟動 Container 時，會透過 <code>-e</code> 標籤設定。</p>
<h3><code>-v</code> 設定 Volume</h3>
<p>介紹完 Docker Volume 的好處後，在實際建立Container時會透過:</p>
<div class="highlight"><pre><span></span>docker run &lt;image名稱&gt; -v <span class="sb">`</span>實體資料夾路徑<span class="sb">`</span>:<span class="sb">`</span>container中資料夾路徑<span class="sb">`</span>
</pre></div>


<p>來綁定 <strong>「主機上的實體資料夾」</strong> 及 <strong>「Container中的資料夾」</strong></p>
<p>接下來我們看看完整的指令: </p>
<div class="highlight"><pre><span></span>docker run --name mongodb <span class="se">\ </span><span class="c1"># 將這個Container命名為 mongodb</span>
-e <span class="nv">MONGO_INITDB_ROOT_USERNAME</span><span class="o">=</span>root <span class="se">\ </span><span class="c1"># 設定環境變數</span>
-e <span class="nv">MONGO_INITDB_ROOT_PASSWORD</span><span class="o">=</span>wistron123 <span class="se">\ </span><span class="c1"># 設定環境變數</span>
-v /mnt
</pre></div>


<h2>啟動 MongoDB Container</h2>
    
                    <p class="blog-content__tags">
                        <span>Post Tags</span>
    
                        <span class="blog-content__tag-list">
                             <a href="#0">Docker</a>
                             <a href="#0">MongoDB</a>
                        </span>
    
                    </p>
    
                    <div class="blog-content__pagenav">
                        <div class="blog-content__nav">














                        </div>
    
                        <div class="blog-content__all">
                            <a href="https://minglunwu.github.io/#note" class="btn btn--primary">
                                View All Post
                            </a>
                        </div>
                    </div>
    
                </div><!-- end blog-content__main -->
            </div> <!-- end blog-content -->
    
        </article>
            <!-- footer
    ================================================== -->
    <footer>
        <div class="row">
            <div class="col-full">

                <div class="footer-logo">
                    <a class="footer-site-logo" href="#0"><img src="https://minglunwu.github.io/theme/images/logo.png" alt="Homepage"></a>
                </div>
                <ul class="footer-social">
                    <li>
                        <a href="https://www.facebook.com/zebra52000" target="_blank"><i class="im im-facebook" aria-hidden="true"></i><span>Facebook</span></a>
                    </li>
                    <li>
                        <a href="https://medium.com/@allen6997535" target="_blank"><i class="im im-book" aria-hidden="true"></i><span>Medium</span></a>
                    </li>
                    <li>
                        <a href="https://github.com/MingLunWu" target="_blank"><i class="im im-github" aria-hidden="true"></i><span>Github</span></a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/allen-ming-lun-wu-637020142/" target="_blank"><i class="im im-linkedin" aria-hidden="true"></i><span>LinkedIn</span></a>
                    </li>
                    <li>
                        <a href="https://www.instagram.com/whoisfater0724/" target="_blank"><i class="im im-instagram" aria-hidden="true"></i><span>Instagram</span></a>
                    </li>
                </ul>
                    
            </div>
        </div>

        <div class="row footer-bottom">

            <div class="col-twelve">
                <div class="copyright">
                    <span>© Copyright Hola 2017</span> 
                    <span>Design by <a href="https://www.styleshout.com/">styleshout</a></span>	
                </div>

                <div class="go-top">
                <a class="smoothscroll" title="Back to Top" href="#top"><i class="im im-arrow-up" aria-hidden="true"></i></a>
                </div>
            </div>

        </div> <!-- end footer-bottom -->

    </footer> <!-- end footer -->
    <!-- Java Script
        ================================================== -->
        <script src="https://minglunwu.github.io/theme/js/jquery-3.2.1.min.js"></script>
        <script src="https://minglunwu.github.io/theme/js/plugins.js"></script>
        <script src="https://minglunwu.github.io/theme/js/main.js"></script>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-161863471-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-161863471-1');
    </script>
    
</body>