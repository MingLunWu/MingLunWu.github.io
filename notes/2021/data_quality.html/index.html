<!doctype html><html lang=en-us><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="Byte and Ink"><meta property="og:type" content="article"><meta property="og:image" content="https://images.unsplash.com/photo-1622976480033-d7458ff18425?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=852&q=80"><meta property="twitter:image" content="https://images.unsplash.com/photo-1622976480033-d7458ff18425?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=852&q=80"><meta name=title content="監控資料品質的旅程"><meta property="og:title" content="監控資料品質的旅程"><meta property="twitter:title" content="監控資料品質的旅程"><meta name=description content><meta property="og:description" content><meta property="twitter:description" content><meta property="twitter:card" content="資料品質為什麼很重要? 如何在現有的ETL流程中加入資料品質檢驗?"><meta name=keyword content="吳明倫, MingLun, minglunwu"><link rel="shortcut icon" href=/img/favicon.ico><title>監控資料品質的旅程 | Byte and Ink</title><link rel=canonical href=/notes/2021/data_quality.html/><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hugo-theme-cleanwhite.min.css><link rel=stylesheet href=/css/zanshang.css><link rel=stylesheet href=/css/font-awesome.all.min.css><script src=/js/jquery.min.js></script>
<script src=/js/bootstrap.min.js></script>
<script src=/js/hux-blog.min.js></script>
<script src=/js/lazysizes.min.js></script></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-NC508K3RBY"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-NC508K3RBY",{anonymize_ip:!1})}</script><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=/>Byte and Ink</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>All Posts</a></li><li><a href=/categories/obsidian/>obsidian</a></li><li><a href=/categories/reading-with-ml/>reading-with-ml</a></li><li><a href=/categories/weekly-reflection/>weekly-reflection</a></li><li><a href=/archive/>ARCHIVE</a></li><li><a href=/about/>ABOUT</a></li><li><a href=/search><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse");$toggle.addEventListener("click",handleMagic);function handleMagic(){$navbar.className.indexOf("in")>0?($navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)):($collapse.style.height="auto",$navbar.className+=" in")}</script><style type=text/css>header.intro-header{background-image:url(https://images.unsplash.com/photo-1622976480033-d7458ff18425?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=852&q=80)}.utterances{max-width:100%}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/fast-api title="Fast API">Fast API</a>
<a class=tag href=/tags/data-quality title="Data Quality">Data Quality</a>
<a class=tag href=/tags/python title=Python>Python</a></div><h1>監控資料品質的旅程</h1><h2 class=subheading></h2><span class=meta>Posted by
MingLun Allen Wu
on
Saturday, December 25, 2021</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h1 id=tldr>TL;DR</h1><p>在資料分析的領域中，資料品質有點像是「溫室效應」: <strong>大家都知道它很重要，卻不是每個人都想花時間處理，然後有一天，就 Fucked Up 了</strong>。</p><p>近期試著在部門建立監控資料品質的機制，透過這篇文章記錄過程中建立的知識點，以及最後是怎麼實作出監控模組，可套用在既有的數百個 ETL。</p><h1 id=到底哪裡出了問題>到底哪裡出了問題?</h1><p>大約半年前，我正在前一份工作建模，在確定了基本的模型架構後，使用手邊現有的資料進行預測，結果相當不錯! 團隊歡欣鼓舞。</p><p>到了下個月，新的資料收集完畢，丟進一樣的模型做預測，結果<strong>慘不忍睹</strong>，團隊成員面面相覷。</p><p>欸! 你有改模型的架構嗎?</p><p>沒&mldr;沒有阿&mldr;?</p><p>會不會這個月的資料本來就怪怪的啊&mldr;?</p><p>我&mldr;我也不知道欸&mldr;</p><p><img src=https://minglunwu.github.io/images/20211224/why.png alt></p><p>模型的架構，可以透過<strong>程式碼版控</strong>去追蹤每個版本的更動。</p><p>而每一批資料的變動是否有異常的情況發生，這就需要花點工夫深入了解了。</p><h1 id=對建模的迷思>對建模的迷思</h1><p>剛踏入資料分析的領域時，有種迷思:</p><blockquote><p>如果預測結果不好，一定是這個模型架構太爛了!</p></blockquote><p>所以花了很多時間去追最新的模型架構、研讀新的論文，陷入了一種「套件工程師」的感覺: <strong>把相同的資料，丟進不同的模型試試，如果表現不好，就再換一種模型</strong>。</p><p>直到上了 Andrew Ng. 的 Coursera 課程 - MLOps Specialization</p><p>其中分享了一個觀念: <code>Model-Centric</code> 與 <code>Data-Centric</code> AI 的不同，分別是透過<strong>改善模型</strong>及<strong>改善資料</strong>兩種截然不同的策略，來達到優化預測結果的目的。</p><p>在 Andrew 公司內部的多個專案中，他們發現<strong>改善資料</strong>的優化幅度是遠大於<strong>改善模型</strong>的。而要做到<strong>改善資料</strong>，前提當然是要深入的瞭解資料。</p><p>如果有興趣的讀者，也可以前往課程觀看相關內容:</p><hr><h1 id=資料品質>資料品質</h1><h2 id=不同面向難有統一標準>不同面向、難有統一標準</h2><p>如果要對資料品質進行較明確的定義，我會這麼形容:</p><blockquote><p>透過指標來評估資料的狀況是否正確及可靠</p></blockquote><p>實際上資料品質涵蓋了許多不同的面向:</p><ul><li>完整度</li><li>一致性</li><li>使用性</li><li>可靠性</li><li>時效性</li></ul><p>這些面向中，很難找到一組標準是「放諸四海皆準」，適用於所有的情況。基本上這些指標是<strong>因應各個分析團隊的需求而異</strong>。</p><p>舉個例子來說: 一批資料缺少了生日欄位，對某些團隊來說，這樣是「無法接受」的，因為少了可以運用的 Feature。</p><p>但或許對於銀行的分析團隊來說，這樣才是「合法」的，因為金融法規有規定做分析前需要進行「去識別化」。</p><hr><h2 id=資料品質標準化>資料品質標準化</h2><p>許多公司其實都有推行自己的資料品質監控平台:</p><ul><li><p><strong>AWS</strong>:</p><p>Amazon建立了<code>Deequ</code>這個工具，用來進行資料品質的計算，並且據此建構了內部的資料品質計算工具。</p><p>Test data quality at scale with Deequ</p></li><li><p><strong>Uber</strong>:</p><p>Uber 則在部落格分享內部的 <code>UDQ</code>(Uber Data Quality Platform)是如何運作的。</p><p>How Uber Achieves Operational Excellence in the Data Quality Experience</p></li></ul><p>其中 <code>Uber</code> 在文章中分享到建立平台前，他們向內部的 Data Consumer 和 Data Producer 分別收集了相關需求，在五花八門的需求中，梳理出幾個類別，這可以協助我們了解常見的資料品質指標:</p><table><thead><tr><th style=text-align:center>類別</th><th style=text-align:center>定義</th></tr></thead><tbody><tr><td style=text-align:center>Completeness</td><td style=text-align:center>資料完整度，從上游任務轉到下游任務時，資料的完整程度</td></tr><tr><td style=text-align:center>Freshness</td><td style=text-align:center>資料轉移過程中，達到99.9%完整度所需的時間</td></tr><tr><td style=text-align:center>Duplicates</td><td style=text-align:center>一批資料中，主鍵是唯一的比例</td></tr><tr><td style=text-align:center>Cross-Datacenter Consistency</td><td style=text-align:center>該批資料與其他資料中心的一致程度</td></tr><tr><td style=text-align:center>Others</td><td style=text-align:center>使用者自行定義，無其他標準</td></tr></tbody></table><hr><h1 id=建立資料品質監控模組>建立資料品質監控模組</h1><p>在規劃及設計這個專案時，考量了幾個重點:</p><ol><li><p><strong>需與現有的ETL流程有極高的相容性</strong>:</p><p>部門現有的ETL流程主要透過<code>Airflow</code>進行驅動，我所設計的模組必須要相容於 <code>Airflow</code> 的流程。如果為了達到資料品質監控目的，而開發了額外的服務，可能會因為相容成本過高，難以推行。</p></li><li><p><strong>能計算基本的資料品質</strong>:</p><p>現有的 ETL 流程約有 400 個，如果每一個流程都需要客製化地設計檢驗項目，需要花費太多人力成本。因此模組需要具備「計算基本指標」的功能，對於任何資料都先做初步的檢驗。</p></li><li><p><strong>使用者可根據需求自訂規則</strong>:</p><p>如同前一節所提到，資料品質的指標<strong>因團隊而異</strong>，除了基本指標外，需要提供接口讓使用者可自行設定客製化的條件。</p></li></ol><p>接下來，就讓我們從基本的 ETL 流程出發，進行一趟資料品質的旅程:</p><p><img src=https://minglunwu.github.io/images/20211224/etl.png alt></p><hr><h2 id=metric-operator>Metric Operator</h2><p>首先，我們先在架構圖中，加入了第一個元件 <code>Metric Operator</code>:</p><p><img src=https://minglunwu.github.io/images/20211224/step1.png alt></p><blockquote><p>對資料進行初步探索、了解基本樣貌</p></blockquote><p>從架構圖中可以看到 <code>Metric Operator</code> 會在 ETL 的過程中，將 Raw Data 分流出來進行基本運算，得到兩個產物: <code>Web Report</code> 及 <code>Metric Table</code>。</p><ul><li><p><strong>Web Report</strong>:</p><p><code>Web Report</code>是理解資料的入口，使用者在設計更複雜的規則前，透過視覺化的報表，可以了解各變數的分布、取得基本的視覺化、得到各項欄位的基礎提示(例如該欄位值皆為空、此欄位分布不均勻&mldr;)</p><p><img src=https://minglunwu.github.io/images/20211224/web_report.jpg alt></p></li><li><p><strong>Metric Table</strong>:</p><p>第二項產物是結構化的<code>Metric Table</code>，<code>Metric Operator</code>滾算各欄位的基本統計量，包含下面幾項:</p><table><thead><tr><th style=text-align:center>欄位</th><th style=text-align:center>意義</th></tr></thead><tbody><tr><td style=text-align:center>n</td><td style=text-align:center>數量</td></tr><tr><td style=text-align:center>n_missing</td><td style=text-align:center>空值數量</td></tr><tr><td style=text-align:center>p_missing</td><td style=text-align:center>空值百分比</td></tr><tr><td style=text-align:center>n_unique</td><td style=text-align:center>unique 數量</td></tr><tr><td style=text-align:center>p_unique</td><td style=text-align:center>unique 百分比</td></tr><tr><td style=text-align:center>n_distinct</td><td style=text-align:center>distinct 數量</td></tr><tr><td style=text-align:center>p_distinct</td><td style=text-align:center>distinct 百分比</td></tr></tbody></table><p>計算出各欄位的基本統計量後，將其轉為結構化報表存放至RDB中。</p></li></ul><hr><h2 id=api-server>API Server</h2><p>接著我們在架構圖中加入<code>API</code>元件:</p><p><img src=https://minglunwu.github.io/images/20211224/api.png alt></p><p>使用者透過 <code>FastAPI</code> 所建立的 <code>API Server</code> 來設定資料品質的檢驗條件。</p><p>(PS: 對於 <code>FastAPI</code> 不熟悉的讀者，歡迎造訪: FastAPI入門筆記(一) - 基本介紹)</p><p>舉例來說:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;user_name&#34;</span>: <span style=color:#f1fa8c>&#34;MingLun&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;checker_name&#34;</span>: <span style=color:#f1fa8c>&#34;first_checker&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f1fa8c>&#34;rules&#34;</span>:[
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;stat_column&#34;</span>: <span style=color:#f1fa8c>&#34;person_id&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;stat_name&#34;</span>: <span style=color:#f1fa8c>&#34;n_distinct&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;operator&#34;</span>: <span style=color:#f1fa8c>&#34;&gt;&#34;</span>,
</span></span><span style=display:flex><span>            <span style=color:#f1fa8c>&#34;threshold&#34;</span>:<span style=color:#bd93f9>100</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    ] 
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>從上述的設定中，我們設定了一個屬於 <code>MingLun</code> 的檢驗物件，檢驗的條件是<code>person_id</code>這個欄位必須要有100個以上的distinct值。</p><p>(我們可能希望這批資料至少要有超過100個人，不能都是同樣的<code>person_id</code>)</p><p><code>API Server</code> 讓使用者(有資料品質檢驗需求的人)可以自由的CRUD檢驗物件，這些物件會在下一節中被使用到。</p><hr><h2 id=rule--validate-operator>Rule / Validate Operator</h2><p>接著我們在原先的架構圖上再加入<code>Rule Operator</code> 及 <code>Validate Operator</code> 兩個元件，現在的架構圖會變成:</p><p><img src=https://minglunwu.github.io/images/20211224/dqm.png alt></p><p><code>Rule Operator</code> 及 <code>Validate Operator</code> 的目的，是讀取使用者所設定的檢驗物件，根據條件，查詢不同的內容:</p><ul><li><p>較簡單的條件:</p><p>如果使用者設定的指標已經在 <code>Metric Table</code> 中被滾算過了，可以直接進行比對，驗證速度極快。 (例如 <code>n_missing</code> &lt; 100)</p></li><li><p>較複雜的條件:</p><p>如果使用者設定較為複雜的條件 (例如該欄位的值需要符合某個 Regular Expression )，此時需要對 Raw Data 進行滾算驗證，需要耗費較大量的時間。</p></li></ul><hr><h2 id=運算框架>運算框架</h2><p>在進行資料品質滾算時，事先調查了幾個適合的框架，較為主流的資料品質檢驗工具有兩項:</p><ol><li><p><strong>AWS Deequ</strong> :</p><p><code>Deequ</code> 是 AWS 所開發的資料品質檢驗工具，底層是以 <code>Java</code> 建構，不過有釋出 Python 接口 (<code>PydDeequ</code>)，由於使用時需要安裝不少相依套件，在銀行內會有安全性的考量，所以作罷。</p><p>不過這還是一套相當主流的工具，也有支援 Spark 的 Integration。</p><p>Deequ 官方網站</p><p>Python Deequ 官方網站</p></li><li><p><strong>Great Expectation</strong>:</p><p><code>Great Expectation</code> 則是 <code>Python-Based</code> 的開源套件，目的與<code>Deequ</code>相同，都是希望能做資料品質的驗證 (<strong>Unit tests for data</strong>)。</p><p>相較於 <code>Deequ</code> 來說，只需要透過 <code>Pypi</code> 安裝即可，相對友善。</p><p>但缺點是文件較差，在版本更迭的過程中，有許多文件尚未補齊，主要是透過 <code>Jupyter Notebook</code> 進行互動式設定。</p><p>如果和我一樣，希望建立一個 <code>Python SDK</code>，底層封裝 <code>Great Expectation</code>的話，對於其環境設定及運行方式，可能需要花一點時間摸索。</p><p>Great Expectation 官方網站</p></li></ol><hr><h2 id=如何達到高相容性>如何達到高相容性?</h2><p>在本節開頭提到，建立此模組的第一個目標就是: <strong>需與現有的ETL流程有極高的相容性</strong>，為了達到此目標，勢必與部門現有的 Airflow 流程做很好的結合。</p><p>開發這個模組時，是先以 <code>Python SDK</code> 作為開發目標，將 <code>Great Expectations</code> 等開源套件封裝成自行定義的規格。</p><p>接著，自行開發 <code>Airflow</code> 的Operator</p><p>(請參閱 - Creating a custom operator - Airflow Documentation)</p><p>這樣的好處是: <strong>只要在原有的ETL DAG中進行擴充，即可達到檢驗資料品質的功能，不會影響到原有的 ETL流程</strong> :</p><p><img src=https://minglunwu.github.io/images/20211224/dag_augmentation.jpg alt></p><hr><h1 id=後話>後話</h1><p>最初是因為新工作在試用期結束前，需要自己完成一個專案，所以開始進行資料品質的研究，也根據現有流程設計一些模組。</p><p>在報告完後得到了不錯的回饋，也準備正式擴充到部門現有的400多個 ETL 上。</p><p>這篇文章算是在忙碌一個段落後，趁著聖誕假期，記憶還沒有模糊前，先將這陣子的知識點做個紀錄及分享。</p><p>整個模組的細節省略了不少，如果各位朋友對於這部分有興趣，歡迎來信或是透過各種方式連絡我，跟我一起深入交流~</p><p>祝大家聖誕快樂!</p><hr><ul class=pager><li class=previous><a href=/notes/2021/ansible_note_2.html/ data-toggle=tooltip data-placement=top title="Ansible 入門筆記(二) - Variable">&larr;
Previous Post</a></li><li class=next><a href=/notes/2022/fast_api_note_3.html/ data-toggle=tooltip data-placement=top title="Fast API 入門筆記 (三) - Query Parameter & Path Parameter">Next
Post &rarr;</a></li></ul><hr><div><h2>See Also</h2><div class=card><div class=card-content style=padding:2px><a class="title is-5" href=https://minglunwu.com/notes/2021/fast_api_note_2.html/>Fast API 入門筆記 (二) - Typing Hint & Async</a>
<span class=heading><time>(May 8, 2021)</time></span></div></div><div class=card><div class=card-content style=padding:2px><a class="title is-5" href=https://minglunwu.com/notes/2021/fast_api_note_1.html/>Fast API 入門筆記 (一) - 基本介紹</a>
<span class=heading><time>(January 21, 2021)</time></span></div></div><div class=card><div class=card-content style=padding:2px><a class="title is-5" href=https://minglunwu.com/notes/2022/fast_api_note_3.html/>Fast API 入門筆記 (三) - Query Parameter & Path Parameter</a>
<span class=heading><time>(January 7, 2022)</time></span></div></div></div><hr><script src=https://utteranc.es/client.js repo=MingLunWu/MingLunWu.github.io issue-term=title theme=github-light crossorigin=anonymous async></script><hr><iframe src=https://minglunwu.substack.com/embed width=100% height=320 style="border:1px solid #eee;background:#fff" frameborder=0 scrolling=no></iframe></div><div class="col-lg-2 col-lg-offset-0
visible-lg-block
sidebar-container
catalog-container"><div class=side-catalog><hr class="hidden-sm hidden-xs"><h5><a class=catalog-toggle href=#>CATALOG</a></h5><ul class=catalog-body></ul></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/tags/ansible title=ansible>ansible</a>
<a href=/tags/book title=book>book</a>
<a href=/tags/cloud title=cloud>cloud</a>
<a href=/tags/concept title=concept>concept</a>
<a href=/tags/fast-api title=fast-api>fast-api</a>
<a href=/tags/fast-api-tutorial title=fast-api-tutorial>fast-api-tutorial</a>
<a href=/tags/music title=music>music</a>
<a href=/tags/note title=note>note</a>
<a href=/tags/pytest-101 title=pytest-101>pytest-101</a>
<a href=/tags/python title=python>python</a>
<a href=/tags/test title=test>test</a>
<a href=/tags/thought title=thought>thought</a>
<a href=/tags/tool title=tool>tool</a>
<a href=/tags/wsgi title=wsgi>wsgi</a></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=mailto:alen6997535@gmail.com><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/minglunwu><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-github fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://www.linkedin.com/in/ming-lun-wu-637020142/><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-linkedin fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://medium.com/@minglun-wu><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fab fa-medium fa-stack-1x fa-inverse"></i></span></a></li><li><a href rel=alternate type=application/rss+xml title="Byte and Ink"><span class="fa-stack fa-lg"><i class="fas fa-circle fa-stack-2x"></i>
<i class="fas fa-rss fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; Byte and Ink 2024<br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function loadAsync(e,t){var s=document,o="script",n=s.createElement(o),i=s.getElementsByTagName(o)[0];n.src=e,t&&n.addEventListener("load",function(e){t(null,e)},!1),i.parentNode.insertBefore(n,i)}</script><script>$("#tag_cloud").length!==0&&loadAsync("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:"#bbbbee",end:"#0085a1"}},$("#tag_cloud a").tagcloud()})</script><script>loadAsync("https://cdn.jsdelivr.net/npm/fastclick@1.0.6/lib/fastclick.min.js",function(){var e=document.querySelector("nav");e&&FastClick.attach(e)})</script><script type=text/javascript>function generateCatalog(e){_containerSelector="div.post-container";var t,n,s,o,i,a=$(_containerSelector),r=a.find("h1,h2,h3,h4,h5,h6");return $(e).html(""),r.each(function(){t=$(this).prop("tagName").toLowerCase(),o="#"+$(this).prop("id"),n=$(this).text(),i=$('<a href="'+o+'" rel="nofollow">'+n+"</a>"),s=$('<li class="'+t+'_nav"></li>').append(i),$(e).append(s)}),!0}generateCatalog(".catalog-body"),$(".catalog-toggle").click(function(e){e.preventDefault(),$(".side-catalog").toggleClass("fold")}),loadAsync("/js/jquery.nav.js",function(){$(".catalog-body").onePageNav({currentClass:"active",changeHash:!1,easing:"swing",filter:"",scrollSpeed:700,scrollOffset:0,scrollThreshold:.2,begin:null,end:null,scrollChange:null,padding:80})})</script></body></html>