<!DOCTYPE html>
<!--[if lt IE 9 ]><html class="no-js oldie" lang="en"> <![endif]-->
<!--[if IE 9 ]><html class="no-js oldie ie9" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html class="no-js" lang="en">
<!--<![endif]-->

<head>
        <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <!--
    <meta name="description" content="">
    <meta name="author" content="">
    -->
    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="https://minglunwu.com/theme/css/base.css">
    <!--<link rel="stylesheet" href="https://minglunwu.com/theme/css/vendor.css">-->
    <link rel="stylesheet" href="https://minglunwu.com/theme/css/main.css">
    <link rel="stylesheet" href="https://minglunwu.com/theme/css/styles.css">

    <!-- script
    ================================================== -->
    <script src="https://minglunwu.com/theme/js/modernizr.js"></script>
    <script src="https://minglunwu.com/theme/js/pace.min.js"></script>
    <!--<script src="https://kit.fontawesome.com/968a4ded4c.js" crossorigin="anonymous"></script>-->

    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="https://minglunwu.com/theme/favicon.ico" type="image/x-icon">
    <link rel="icon" href="https://minglunwu.com/theme/favicon.ico" type="image/x-icon">

    <title>Fast API 入門筆記 (三) - Query Parameter & Path Parameter</title>
    <meta property="og:title" content="Fast API 入門筆記 (三) - Query Parameter & Path Parameter">
    <meta name="description" content="<p>本篇筆記試著說明 <code>FastAPI</code> 的 <code>Path Parameters</code>、<code>Query Parameters</code> 的區別，以及適用的情境。</p>">
    <meta property="og:description" content="<p>本篇筆記試著說明 <code>FastAPI</code> 的 <code>Path Parameters</code>、<code>Query Parameters</code> 的區別，以及適用的情境。</p>">
    <meta name="author" content="MingLun Allen Wu">
    <meta property="og:image" content="https://images.unsplash.com/reserve/oGLumRxPRmemKujIVuEG_LongExposure_i84.jpeg?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1353&q=80">
    
    <link rel="image_src" type="image/jpeg" href="https://images.unsplash.com/reserve/oGLumRxPRmemKujIVuEG_LongExposure_i84.jpeg?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1353&q=80" />
    <style>
        img{
            display: block;
            margin-left: auto;
            margin-right: auto;
        }
    </style>
</head>

<body id="top">
            <!-- header
    ================================================== -->
    <header class="s-header">

        <div class="header-logo">
            <a class="site-logo" href="https://minglunwu.com"><img src="https://minglunwu.com/theme/images/logo.png" width="160" height="56" alt="Homepage"></a>
        </div>

        <nav class="header-nav-wrap">
            <ul class="header-nav">
                <li class="current"><a href="https://minglunwu.com/#home" title="home">Home</a></li>
                <li><a href="https://minglunwu.com/#about" title="about">About</a></li>
                <li><a href="https://minglunwu.com/#blog" title="blog">Blogs</a></li>
                <li><a href="https://minglunwu.com/#note" title="note">Notes</a></li>
                <!--<li><a class="smoothscroll" href="#note" title="notes">Notes</a></li>-->
                <!--<li><a class="smoothscroll"  href="#contact" title="contact">Contact</a></li>-->
            </ul>
        </nav>

        <a class="header-menu-toggle" href="#0"><span>Menu</span></a>

    </header> <!-- end s-header -->

        <article class="blog-single">

            <!-- page header/blog hero
            ================================================== -->
            <div class="page-header page-header--single page-hero" style="background-image:url(https://images.unsplash.com/reserve/oGLumRxPRmemKujIVuEG_LongExposure_i84.jpeg?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1353&q=80)">
            
                <div class="row page-header__content narrow">
                    <article class="col-full">
                        <div class="page-header__info">
                            <div class="page-header__cat">
                                    <a href="#0">Fast API</a>
                                    <a href="#0">Python</a>
                            </div>
                        </div>
                        <h1 class="page-header__title">
                            <a href="#0" title="">
                                Fast API 入門筆記 (三) - Query Parameter & Path Parameter
                            </a>
                        </h1>
                        <ul class="page-header__meta">
                            <li class="date">2022-Jan-07 (Fri)</li>
                            <li class="author">
                                By
                                <span>MingLun Allen Wu</span>
                            </li>
                            <li> views</li>
                        </ul>
                        
                    </article>
                </div>
        
            </div> <!-- end page-header -->
    
            <div class="row blog-content">
                <div class="col-full blog-content__main">
                    
                    <p><strong>重溫舊夢：</strong></p>
<ul>
<li><a href="https://minglunwu.github.io/notes/2021/fast_api_note_1.html">Fast API 入門筆記(一) - 基本介紹</a></li>
<li><a href="https://minglunwu.github.io/notes/2021/fast_api_note_2.html">Fast API 入門筆記(二) - Typing Hint &amp; Async</a></li>
</ul>
<h1>TL; DR</h1>
<p>做為一個 API 框架， <code>FastAPI</code> 需要以多種方式接受外部傳送的變數(例如 <em>GET</em>、<em>POST</em>)。</p>
<p>本篇筆記試著說明 <code>FastAPI</code> 的 <code>Path Parameters</code>、<code>Query Parameters</code> 的區別，以及適用的情境。</p>
<h2>Path Parameter</h2>
<blockquote>
<p>透過預先定義好的「位置」來接受參數</p>
</blockquote>
<h3>基本操作</h3>
<p>使用 <code>Path Parameter</code> 時，使用<code>{}</code>在路徑中設定一個參數，舉例來說：</p>
<p>我們希望建立一個 GET 的 API，可以接受使用者的名字 <code>user_name</code>: </p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/users/</span><span class="si">{user_name}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># 透過{user_name} 設定參數位置</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">read_user</span><span class="p">(</span><span class="n">user_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="n">user_name</span><span class="p">}</span>
</pre></div>


<p><br></p>
<p>在 <code>read_user(user_name)</code> 中定義了 <code>user_name</code> 參數後， <code>FastAPI</code> 會自動去註冊的路徑中尋找 <code>{user_name}</code> 的位置。</p>
<p>當<code>FastAPI</code>接收到符合條件的 Request(/users/{user_name})時，會自動將 <code>{user_name}</code> 位置的值當成<code>read_user()</code>的<code>user_name</code>參數送入。</p>
<p><br>
舉例來說： </p>
<ol>
<li>當 API 運行後，在瀏覽器輸入: <a href="#">http://127.0.0.1:8000/users/MingLun</a></li>
<li>
<p>由於註冊了 <code>users/{user_name}</code> 規則，<code>FastAPI</code> 識別到該規則，因此將<code>{user_name}</code> 位置的值(MingLun)當作參數送入 <code>read_user()</code></p>
</li>
<li>
<p>根據函式的運行邏輯，將會得到下列的回傳值: </p>
</li>
</ol>
<div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="s2">&quot;MingLun&quot;</span><span class="p">}</span>
</pre></div>


<h3>預先設定型態</h3>
<blockquote>
<p>在設定參數時，可以預先定義變數型態，<code>FastAPI</code>會協助進行轉換及驗證。</p>
</blockquote>
<p>了解 <code>Path Variable</code> 的基本使用方式後，可以在函式設定參數時，加入 Python 的 <code>Typing Hint</code>:</p>
<p><strong>重溫舊夢 - <a href="https://minglunwu.github.io/notes/2021/fast_api_note_2.html">Fast API 入門筆記(二) - Typing Hint &amp; Async</a></strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/get_number/</span><span class="si">{number}</span><span class="s2">&quot;</span><span class="p">)</span> 

<span class="k">async</span> <span class="k">def</span> <span class="nf">read_number</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="n">number</span><span class="p">}</span>
</pre></div>


<p><br></p>
<p>此時如果在瀏覽器輸入: <a href="">http://127.0.0.1:8000/get_number/1313</a></p>
<p><code>FastAPI</code>執行時會以<strong>str</strong>的格式將<code>"1313"</code>當成參數送入函式，但由於在 <code>read_number()</code> 中定義的 <code>number</code> 參數已經定義了型態 <strong>int</strong>，<code>FastAPI</code>處理時會嘗試將 <code>"1313"</code> 轉換為 <strong>int</strong> 格式，因此你將會得到: </p>
<div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="mi">1313</span><span class="p">}</span>
</pre></div>


<p>而非:</p>
<div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;number&quot;</span><span class="p">:</span> <span class="s2">&quot;1313&quot;</span><span class="p">}</span>
</pre></div>


<p><strong>例外情況: 如果出現無法轉換的情況</strong></p>
<p>接續上述的情境，倘若此時我們在瀏覽器輸入: <a href="">http://127.0.0.1/get_number/MingLun</a></p>
<p>此時 <code>FastAPI</code> 同樣會試著將 <code>{number}</code> 位置的參數轉換為 <strong>int</strong> 格式，也就是將 <code>MingLun</code> 轉換為 <strong>int</strong>，可預見此時會發生錯誤。</p>
<p>有趣的是，當出現這種意外情境時， <code>FastAPI</code>不會直接噴出 <strong>500 Internal Server Error</strong>，而是會有固定的 HTTP Error 範本，提供使用者基本的錯誤資訊: </p>
<div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;detail&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="p">[</span>
                <span class="s2">&quot;path&quot;</span><span class="p">,</span>
                <span class="s2">&quot;number&quot;</span>
            <span class="p">],</span>
            <span class="s2">&quot;msg&quot;</span><span class="p">:</span> <span class="s2">&quot;value is not a valid interger&quot;</span><span class="p">,</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;type_error.integer&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<h2>順序帶來的影響</h2>
<blockquote>
<p>在使用 <code>Path Parameter</code> 時，多個 EndPoint 的順序是會有影響的</p>
</blockquote>
<p>由於 <code>FastAPI</code> 可定義多層路徑 (Ex: <code>/A/B/C</code>)，所以有時候會發生多個 EndPoint 路徑重疊的情況，此時 <code>FastAPI</code> 將會依照註冊的順序查找。</p>
<p>舉例來說，我們設計一個 API Endpoint (<code>get_info</code>)，可以根據使用者的<code>pID</code> 來取得相關資訊。 同時如果提供了一個保留字 (<code>SUPERUSER</code>)，則回傳不一樣的資訊。 </p>
<p><strong>(實際上沒有人會這樣設計，這只是個範例)</strong></p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/get_info/SUPERUSER&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_info_super_user</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;YOU ARE SUPER USER!&quot;</span><span class="p">}</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/get_info/</span><span class="si">{pID}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="n">pID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">pID</span><span class="p">}</span>
</pre></div>


<p>當<code>FastAPI</code>接收到: <a href="">http://127.0.0.1/get_info/SUPERUSER</a>時，會從上至下檢查各個註冊的路徑。</p>
<p>以上述範例來說，會進入 <code>get_info_super_user()</code>函式，得到特殊的回應。</p>
<p>接著看看錯誤的情境，我們將兩個路徑對調:</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/get_info/</span><span class="si">{pID}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># 原本在下方</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_info</span><span class="p">(</span><span class="n">pID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">pID</span><span class="p">}</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/get_info/SUPERUSER&quot;</span><span class="p">)</span> <span class="c1"># 原本在上方</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">get_info_super_user</span><span class="p">():</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;YOU ARE SUPER USER!&quot;</span><span class="p">}</span>
</pre></div>


<p>此時再次發送  <a href="">http://127.0.0.1/get_info/SUPERUSER</a>
會發生什麼事情？</p>
<p><code>FastAPI</code> 接受到請求後，由上而下判斷規則，當判斷到第一個規則(也就是 <code>get_info()</code>)時，會直接進入執行，回傳:</p>
<div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="s2">&quot;SUPERUSER&quot;</span><span class="p">}</span>
</pre></div>


<p>順序擺放錯誤時，永遠無法進入 <code>get_info_super_user()</code> 的 Endpoint.</p>
<blockquote>
<p><strong>設計時，條件較為嚴格的EndPoint，要放在較上方</strong></p>
</blockquote>
<h2>Query Parameter</h2>
<blockquote>
<p>用來接受URL所附加的參數，與 <code>Path Parameter</code> 最大的差別在於沒有預先定義位置</p>
</blockquote>
<p>透過 GET 請求傳送多個參數時，常會附加在URL上，例如:</p>
<p><a href="">http://xxx.example.com/target?param1=a&amp;param2=b</a></p>
<p>接收這些變數並進行處理，就是 <code>Query Parameter</code> 所負責的任務。</p>
<h3>基本操作</h3>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>
<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/path_param_example/</span><span class="si">{pID}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># 路徑中包含參數，屬於 Path Parameter</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">path_param_example</span><span class="p">(</span><span class="n">pID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">pID</span><span class="p">}</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/query_param_example&quot;</span><span class="p">)</span> <span class="c1"># 路徑中不包含參數，屬於 Query Parameter</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">query_param_example</span><span class="p">(</span><span class="n">pID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">pID</span><span class="p">}</span>
</pre></div>


<p>從上述範例中，我們可以區別 <code>Query Parameter</code> 與 <code>Path Parameter</code> 的最大差異是 : <strong>路徑中是否有預留參數的位置</strong>。</p>
<p>以 <code>Query Parameter</code> 來說，由於沒有在路徑中預留參數的位置，參數會掛載在URL後。</p>
<p>以上方案例來說，傳送的方式會如下: </p>
<p><a href="">http://127.0.0.1/query_param_example?pID=abc01</a></p>
<h3>預先設定型態</h3>
<p>與 <code>Path Parameter</code> 相同，使用 <code>Query Parameter</code> 時也能透過預先定義參數型態，來觸發 <code>FastAPI</code> 自動檢驗、轉換的功能: </p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">fastapi</span> <span class="kn">import</span> <span class="n">FastAPI</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">FastAPI</span><span class="p">()</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/query_param_str&quot;</span><span class="p">)</span> 
<span class="k">async</span> <span class="k">def</span> <span class="nf">query_param_str</span><span class="p">(</span><span class="n">pID</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span> <span class="c1"># 轉換成字串</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">pID</span><span class="p">}</span>

<span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/query_param_int&quot;</span><span class="p">)</span>
<span class="k">async</span> <span class="k">def</span> <span class="nf">query_param_int</span><span class="p">(</span><span class="n">pID</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span> <span class="c1"># 轉換成整數</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">pID</span><span class="p">}</span>
</pre></div>


<p>在上述的例子中，我們定義了兩個EndPoint，差別在於設定參數時，分別指定了 <code>str</code> 和 <code>int</code> 格式。</p>
<p>當我們同時傳送: </p>
<ul>
<li>
<p><a href="">http://127.0.0.1/query_param_str?pID=1234</a></p>
<p>由於 <code>pID</code> 被預設為 <code>str</code>，將會收到: </p>
<p><code>python
{"user": "1234"} # 字串型態</code></p>
</li>
<li>
<p><a href="">http://127.0.0.1/query_param_int?pID=1234</a></p>
<p>由於 <code>pID</code> 被預設為 <code>int</code>，將會收到:</p>
<p><code>python
{"user": 1234} # 整數型態</code></p>
</li>
</ul>
<p><code>FastAPI</code> 會根據參數所指定的型態，自動轉換收到的值，當轉換失敗時，同樣會回傳結構化的錯誤訊息。</p>
<h2>透過參數的設置來決定行為</h2>
<p>在上述筆記中，透過參數的設置，能夠設定 <code>FastAPI</code> 在接收外部傳送的值時，如何進行型態的轉換。 </p>
<p>實際上，透過參數設置，還能做到更多的行為: </p>
<h3>1. 設定預設值</h3>
<p>在參數上設定預設值時，使用者呼叫 API Endpoint 時，如果沒有夾帶該參數，會自動以預設值帶入: </p>
<div class="highlight"><pre><span></span><span class="nd">@app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;/default_param&quot;</span><span class="p">)</span> 
<span class="k">async</span> <span class="k">def</span> <span class="nf">query_param_str</span><span class="p">(</span><span class="n">param_a</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">param_b</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">):</span> <span class="c1"># 轉換成字串</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;param_a&quot;</span><span class="p">:</span> <span class="n">param_a</span><span class="p">,</span> <span class="s2">&quot;param_b&quot;</span><span class="p">:</span> <span class="n">param_b</span><span class="p">}</span>
</pre></div>


<p>當使用者輸入: <a href="">http://127.0.0.1/default_param&amp;param_a=abc</a></p>
<p>將會收到: </p>
<div class="highlight"><pre><span></span>    <span class="p">{</span><span class="s2">&quot;param_a&quot;</span><span class="p">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">,</span> <span class="s2">&quot;param_b&quot;</span><span class="p">:</span> <span class="s2">&quot;example&quot;</span><span class="p">}</span>
</pre></div>


<h3>2. 選擇性參數</h3>
<p>在建立 Endpoint 時，有些參數是 Optional ，不見得每次都要攜帶，例如建立一個 Endpoint 有下列條件: </p>
<ul>
<li>必須要提供 <code>user_name</code></li>
<li>不一定要提供 <code>gender</code></li>
</ul>
<p>此時我們可以透過 Typing Hint 來讓 <code>gender</code> 欄位可以是 <code>str</code> 或是 <code>None</code>(不存在):</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span>
<span class="k">def</span> <span class="nf">optional_example</span><span class="p">(</span><span class="n">user_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">gender</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="kc">None</span><span class="p">]):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="n">user_name</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="n">gender</span><span class="p">}</span>
</pre></div>


<p>除了使用 <code>Union</code> 額外指定 <code>None</code> 型態外，還可以使用更簡潔的語法 <code>Optional</code>: </p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Optional</span>
<span class="k">def</span> <span class="nf">optional_example</span><span class="p">(</span><span class="n">user_name</span><span class="p">:</span><span class="nb">str</span><span class="p">,</span> <span class="n">gender</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;user_name&quot;</span><span class="p">:</span> <span class="n">user_name</span><span class="p">,</span> <span class="s2">&quot;gender&quot;</span><span class="p">:</span> <span class="n">gender</span><span class="p">}</span>
</pre></div>


<blockquote>
<p><code>Optional[str]</code> 與 <code>Union[str, None]</code> 是完全等價的</p>
</blockquote>
<h2>結論</h2>
<p>本篇筆記介紹了 <code>FastAPI</code> 的 <code>Path Parameter</code> 和 <code>Query Parameter</code>，除了比較兩者的差別，也介紹 <code>FastAPI</code> 如何透過參數的設定來達到「型態轉換」、「結構化錯誤訊息」。</p>
<p><code>Path Parameter</code>是接受特定位置的參數，而<code>Query Parameter</code> 則是接受 「GET 請求掛載在URL後面的參數」。</p>
<p>在下一篇筆記，我們會更進一步介紹如何使用 <code>FastAPI</code> 的 <code>BaseModel</code> 來定義「參數物件」，接受 POST 請求所傳送的多項參數。</p>
<p>我們下次見!</p>
<p>&lt;未完待續&gt;</p>
    
                    <p class="blog-content__tags">
                        <span>Post Tags</span>
    
                        <span class="blog-content__tag-list">
                             <a href="#0">Fast API</a>
                             <a href="#0">Python</a>
                        </span>
    
                    </p>
    
                    <div class="blog-content__pagenav">
                        <div class="blog-content__nav">










































                            <div class="blog-content__prev">
                                <a href="https://minglunwu.com/notes/2022/pytest_101.html" rel="prev">
                                    <span>Previous Post</span>
                                    Pytest 101 - 給 Python 開發者的測試入門
                                </a>
                            </div>
                            <div class="blog-content__next">
                                <a href="https://minglunwu.com/notes/2021/data_quality.html" rel="next">
                                    <span>Next Post</span>
                                    監控資料品質的旅程
                                </a>
                            </div>
                        </div>
    
                        <div class="blog-content__all">
                            <a href="https://minglunwu.com/archives.html" class="btn btn--primary">
                                View All Post
                            </a>
                        </div>
                    </div>
    
                </div><!-- end blog-content__main -->
            </div> <!-- end blog-content -->
    
        </article>
        <script src="https://utteranc.es/client.js"
                repo="MingLunWu/MingLunWu.github.io"
                issue-term="pathname"
                theme="github-dark-orange"
                crossorigin="anonymous"
                async>
        </script>
        <!-- Comment Box 留言系統 - 需要調整位置 -->
        <!-- <div class="commentbox"></div>
        <script src="https://unpkg.com/commentbox.io/dist/commentBox.min.js"></script>
        <script>commentBox('5640802722119680-proj')</script> -->
            <!-- footer
    ================================================== -->
    <footer>
        <div class="row">
            <div class="col-full">

                <div class="footer-logo">
                    <a class="footer-site-logo" href="#0"><img src="https://minglunwu.com/theme/images/logo.png" alt="Homepage"></a>
                </div>
                <ul class="footer-social">
                    <li>
                        <a href="https://www.facebook.com/zebra52000" target="_blank"><i class="im im-facebook" aria-hidden="true"></i><span>Facebook</span></a>
                    </li>
                    <li>
                        <a href="https://minglun-wu.medium.com" target="_blank"><i class="im im-book" aria-hidden="true"></i><span>Medium</span></a>
                    </li>
                    <li>
                        <a href="https://github.com/MingLunWu" target="_blank"><i class="im im-github" aria-hidden="true"></i><span>Github</span></a>
                    </li>
                    <li>
                        <a href="https://www.linkedin.com/in/%E6%98%8E%E5%80%AB-%E5%90%B3-637020142/" target="_blank"><i class="im im-linkedin" aria-hidden="true"></i><span>LinkedIn</span></a>
                    </li>
                    <li>
                        <a href="https://www.instagram.com/fade_relish/" target="_blank"><i class="im im-instagram" aria-hidden="true"></i><span>Instagram</span></a>
                    </li>
                </ul>
                    
            </div>
        </div>

        <div class="row footer-bottom">

            <div class="col-twelve">
                <div class="copyright">
                    <span>© Copyright MingLunWu 2021</span> 
                    <span>Design by <a href="https://www.styleshout.com/">styleshout</a></span>	
                </div>

                <div class="go-top">
                <a class="smoothscroll" title="Back to Top" href="#top"><i class="im im-arrow-up" aria-hidden="true"></i></a>
                </div>
            </div>

        </div> <!-- end footer-bottom -->

    </footer> <!-- end footer -->
    <!-- Java Script
        ================================================== -->
        <script src="https://minglunwu.com/theme/js/jquery-3.2.1.min.js"></script>
        <script src="https://minglunwu.com/theme/js/plugins.js"></script>
        <script src="https://minglunwu.com/theme/js/main.js"></script>

    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-161863471-1"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-161863471-1');
    </script>
    
</body>